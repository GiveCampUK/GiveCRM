@model GiveCRM.Models.Member
@{
    ViewBag.Title = "Add";
}

<h2>Add Member</h2>

<div>

@{Html.BeginForm("Save", "Member", FormMethod.Post, new {id="addMember"});}

@Html.HiddenFor(m => m.Id)

@Html.LabelFor(m=>m.Reference) @Html.TextBoxFor(m => m.Reference)<br />

@Html.LabelFor(m => m.Title) @Html.TextBoxFor(m=> m.Title)<br />

@Html.LabelFor(m => m.Salutation) @Html.TextBoxFor(m=> m.Salutation)<br />

@Html.LabelFor(m => m.FirstName) @Html.TextBoxFor(m => m.FirstName)<br />

@Html.LabelFor(m => m.LastName) @Html.TextBoxFor(m => m.LastName)<br />

@Html.LabelFor(m => m.AddressLine1) @Html.TextBoxFor(m => m.AddressLine1)<br />

@Html.LabelFor(m => m.AddressLine2) @Html.TextBoxFor(m => m.AddressLine2)<br />

@Html.LabelFor(m => m.City) @Html.TextBoxFor(m => m.City)<br />

@Html.LabelFor(m => m.PostalCode) @Html.TextBoxFor(m => m.PostalCode)<br />

@Html.LabelFor(m => m.Region) @Html.TextBoxFor(m=> m.Region)<br />

@Html.LabelFor(m => m.Country) @Html.TextBoxFor(m => m.Country)<br />

@Html.LabelFor(m => m.EmailAddress) @Html.TextBoxFor(m => m.EmailAddress)<br />


<div id="PhoneNumbers">
@{
    int i = 0; 
    foreach(var phone in Model.PhoneNumbers)
    {
        <label for="PhoneNumbers[@i].NumberBox">@phone.Type</label><input id="PhoneNumbers[@i].NumberBox" name="PhoneNumbers[@i].Number" type="text" disabled value="@phone.Number" /><br />
        <input type="hidden" name="PhoneNumbers[@i].Number" value="@phone.Number" />
        <input type="hidden" name="PhoneNumbers[@i].MemberId" value="@phone.MemberId" />
        <input type="hidden" class="numbertype" name="PhoneNumbers[@i].Type" value="@phone.Type" />
        i += 1; 
    }
}
</div>

<div id="AddNumber">
    <label for="AddNumber_Type">Number Type</label><select id="AddNumber_Type" name="AddNumber_Type">
                                                    <option value="Home">Home</option>
                                                    <option value="Mobile">Mobile</option>
                                                    <option value="Work">Work</option>
                                                </select><br />
    <label for="AddNumber_Number">Number</label><input id="AddNumber_Number" name="number" type="text" />
    <input id="AddNumber_Button" type="button" value="Add Number"  /><br />
</div>

<input type="submit" value="Save" />
@{Html.EndForm();}

<div>

<script type="text/javascript">

    $(function () {
        $('#AddNumber_Button').click(function () {
            var index = $('.numbertype').length;
            var type = HtmlEncode($('#AddNumber_Type option:selected').attr('value'));
            var number = HtmlEncode($('#AddNumber_Number').val());
            $('#AddNumber_Number').val('');
            if (number.trim() === '')
                return;
            $('#PhoneNumbers').append('<label for="PhoneNumbers[' + index + '].NumberBox">' + type +
                                      '</label><input name="PhoneNumbers[' + index + '].NumberBox" type="text" value="' + number + '" disabled /><br />' +
                                      '<input name="PhoneNumbers[' + index + '].Number" type="hidden" value="' + number + '" />' + 
                                      '<input type="hidden" class="numbertype" name="PhoneNumbers[' + index + '].Type" value="' + type + '" />');

        });

        var HtmlEncode = function (val) {
            return $('<div/>').text(val).html();
        };
    }); 
</script>


</div>